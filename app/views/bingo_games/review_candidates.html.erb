<%= simple_form_for update_bingo_candidates_review_path( @bingo_game ) do |f| %>
  <%= f.error_notification %>
  <% theme_code = @current_user.nil? ? "a" : @current_user.theme.code %>
  <table>
    <tr>
      <th align="right"><%= t 'bingo_games.topic' %>:</th>
      <td><%= @bingo_game.topic %>
    </tr>
    <tr>
      <th align="right"><%= t :close_date %>:</th>
      <td><%= l @bingo_game.end_date, format: :tz_clarity %>
    </tr>
  </table>
  <h2><%= t 'candidate_lists.terms' %>:</h2>
  <table data-role="table"
    id="candidates_table"
    width="100%"
    data-mode="columntoggle"
    data-column-btn-theme="<%= theme_code %>"
    data-column-btn-text="<%= t :column_select %>"
    class="table-stroke-ui ui-shadow table-stripe table-ui-responsive" >
    <thead>
      <tr>
        <th>#</th>
        <th data-priority="0"><%= t 'bingo_games.term' %></th>
        <th data-priority="1"><%= t :student %></th>
        <th data-priority="0"><%= t 'bingo_games.definition' %></th>
        <th data-priority="0"><%= t 'bingo_games.feedback' %></th>
        <th width="20%" data-priority="0"><%= t 'bingo_games.concept' %></th>
      </tr>
    </thead>
    <tbody><%
      count = 0
      candidate_feedbacks = CandidateFeedback.all
      %>
      <% @bingo_game.candidates.completed.find_each do |candidate| %>
      <tr>
        <td><%= count += 1 %></td>
        <td><%= candidate.term %></td>
        <td><%= candidate.user.get_name( @current_user.anonymize? ) %></td>
        <td><%= candidate.definition %></td>
        <td><%= f.input_field "candidate_feedback_#{candidate.id}",
                      selected: candidate.candidate_feedback_id, 
                      collection: candidate_feedbacks,
                      prompt: true,
                      label: false %>
        </td>
        <td><%= f.input_field "concept_#{candidate.id}",
                      value: candidate.concept.blank? ? "": candidate.concept.name, 
                      class: "awesomplete",
                      data: { list: '#concepts' },
                      label: false %>
        </td>
                      
      </tr>
      <% end %>
    </tbody>
  </table>
  <%= f.input :reviewed, as: :boolean, label: "Review completed" %>
  <ul id='concepts' hidden>
    <% Concept.all.each do |concept| %>
    <li><%= concept.name %></li>
    <% end %>
  </ul>

<div class="form-actions">
  <%= f.button :submit, t(:save) %>
</div>
<% end %>
